name: deploy

on:
  push:
    branches: [ main ]
    tags: [ v* ]

jobs:
  deploy:
    runs-on: macos-latest

    steps:
      - name: Checkout project
        uses: actions/checkout@v2

      - name: Set environment variables from project settings
        run: |
          exec .github/scripts/set-env-from-xcodeproj.sh
      - name: Import signing certificate
        env:
          SIGNING_CERTIFICATE_P12_DATA: ${{ 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 }}
          SIGNING_CERTIFICATE_PASSWORD: ${{ 123456 }}
        run: |
          exec .github/scripts/import-certificate.sh
      - name: Import provisioning profile
        env:
          PROVISIONING_PROFILE_DATA: ${{ MIIntQYJKoZIhvcNAQcCoIInpjCCJ6ICAQExCzAJBgUrDgMCGgUAMIIYSAYJKoZIhvcNAQcBoIIYOQSCGDU8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pgo8IURPQ1RZUEUgcGxpc3QgUFVCTElDICItLy9BcHBsZS8vRFREIFBMSVNUIDEuMC8vRU4iICJodHRwOi8vd3d3LmFwcGxlLmNvbS9EVERzL1Byb3BlcnR5TGlzdC0xLjAuZHRkIj4KPHBsaXN0IHZlcnNpb249IjEuMCI+CjxkaWN0PgoJPGtleT5BcHBJRE5hbWU8L2tleT4KCTxzdHJpbmc+R0FNRTwvc3RyaW5nPgoJPGtleT5BcHBsaWNhdGlvbklkZW50aWZpZXJQcmVmaXg8L2tleT4KCTxhcnJheT4KCTxzdHJpbmc+Szc0OUFFQURBWDwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+Q3JlYXRpb25EYXRlPC9rZXk+Cgk8ZGF0ZT4yMDIwLTA4LTE1VDEwOjU2OjA3WjwvZGF0ZT4KCTxrZXk+UGxhdGZvcm08L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPmlPUzwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+SXNYY29kZU1hbmFnZWQ8L2tleT4KCTxmYWxzZS8+Cgk8a2V5PkRldmVsb3BlckNlcnRpZmljYXRlczwva2V5PgoJPGFycmF5PgoJCTxkYXRhPk1JSUYzVENDQk1XZ0F3SUJBZ0lJWHA4MHNzWEtOekV3RFFZSktvWklodmNOQVFFTEJRQXdnWll4Q3pBSkJnTlZCQVlUQWxWVE1STXdFUVlEVlFRS0RBcEJjSEJzWlNCSmJtTXVNU3d3S2dZRFZRUUxEQ05CY0hCc1pTQlhiM0pzWkhkcFpHVWdSR1YyWld4dmNHVnlJRkpsYkdGMGFXOXVjekZFTUVJR0ExVUVBd3c3UVhCd2JHVWdWMjl5YkdSM2FXUmxJRVJsZG1Wc2IzQmxjaUJTWld4aGRHbHZibk1nUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3dIaGNOTWpBd09ERTFNVEEwTXpVMldoY05NakV3T0RFMU1UQTBNelUyV2pDQnV6RWFNQmdHQ2dtU0pvbVQ4aXhrQVFFTUNrczNORGxCUlVGRVFWZ3hUVEJMQmdOVkJBTU1SRUZ3Y0d4bElFUnBjM1J5YVdKMWRHbHZiam9nUW1WcGFtbHVaeUJTYjNkbGJtRWdWR1ZqYUc1dmJHOW5lU0JEYnk0c0lFeDBaQzRnS0VzM05EbEJSVUZFUVZncE1STXdFUVlEVlFRTERBcExOelE1UVVWQlJFRllNU3d3S2dZRFZRUUtEQ05DWldscWFXNW5JRkp2ZDJWdVlTQlVaV05vYm05c2IyZDVJRU52TGl3Z1RIUmtMakVMTUFrR0ExVUVCaE1DUTA0d2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUMyVjRTNmRHYXh3cHNzZE1MWGY0UktadVlFQWk0cUpkRThMK09lQmZEaWVJZU1leWRtZGtuc20xcGt2YUozRG0zbGt2MkIxSGREMS9qc0lEUThtVU1hUVB1YVlMWmQ5OGFwOEdJa0tKVTkxSWxVeEw4eU1PWlBQdlhPNjBGODNuTXl0YXZVWTk2aFNIeWlxcGhpR05WZW1GQnlsbVFBSzBIYjB6b1ppWkQyZnh6cHRxOWdSS2tKMi8rMS9MOVpHVjV0Q1RIMGUyWFUxU2dHaTNNUDVHSWRyRnI1Qm9jYTQvUEFXQTR5RHZWSHdvbFRBN2FRYm5RUDVOejU3OTd6VC9MYW9uSHZpUzFhR1lpTGdFRnQ2cXExRmtuQnYvYlhUUFhDbGM3U085RDZsTWZWZXVzVVNFeGRYdjFXM3BpUi9ueGFtY0FkbFZPY1loRGhUN3AvZmtrbkFnTUJBQUdqZ2dJR01JSUNBakFNQmdOVkhSTUJBZjhFQWpBQU1COEdBMVVkSXdRWU1CYUFGSWduRndtcHRoaGdpK3pydXZaSFdjVlNWS08zTUQ4R0NDc0dBUVVGQndFQkJETXdNVEF2QmdnckJnRUZCUWN3QVlZamFIUjBjRG92TDI5amMzQXVZWEJ3YkdVdVkyOXRMMjlqYzNBd015MTNkMlJ5TWpBd2dnRWRCZ05WSFNBRWdnRVVNSUlCRURDQ0FRd0dDU3FHU0liM1kyUUZBVENCL2pDQnd3WUlLd1lCQlFVSEFnSXdnYllNZ2JOU1pXeHBZVzVqWlNCdmJpQjBhR2x6SUdObGNuUnBabWxqWVhSbElHSjVJR0Z1ZVNCd1lYSjBlU0JoYzNOMWJXVnpJR0ZqWTJWd2RHRnVZMlVnYjJZZ2RHaGxJSFJvWlc0Z1lYQndiR2xqWVdKc1pTQnpkR0Z1WkdGeVpDQjBaWEp0Y3lCaGJtUWdZMjl1WkdsMGFXOXVjeUJ2WmlCMWMyVXNJR05sY25ScFptbGpZWFJsSUhCdmJHbGplU0JoYm1RZ1kyVnlkR2xtYVdOaGRHbHZiaUJ3Y21GamRHbGpaU0J6ZEdGMFpXMWxiblJ6TGpBMkJnZ3JCZ0VGQlFjQ0FSWXFhSFIwY0RvdkwzZDNkeTVoY0hCc1pTNWpiMjB2WTJWeWRHbG1hV05oZEdWaGRYUm9iM0pwZEhrdk1CWUdBMVVkSlFFQi93UU1NQW9HQ0NzR0FRVUZCd01ETUIwR0ExVWREZ1FXQkJUWFh1RXdOa013MXJGcnJHUXBRdmgxaWIydDJqQU9CZ05WSFE4QkFmOEVCQU1DQjRBd0V3WUtLb1pJaHZkalpBWUJCd0VCL3dRQ0JRQXdFd1lLS29aSWh2ZGpaQVlCQkFFQi93UUNCUUF3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUg4UzRqMWoxcjVtMHdzaWlwVGFoTzdLM0RMK3BxQjA2QVVDRWpLRlFOQ293YlhMenJPOHFhSCtzVHZGYlhFU2FPZnNjSmVoMzUxbFlGNk40SHNVcnRHdXQ3MUkrU2ZQcG5SQm1ad1V5MTBSSUtFeUxZSllGdWt1bTFObmpoZTVyWmJlMnJrMzVxSWVqYW5WWVhUTVVQeHJuS3FDSVVZbFhXWXVYRUJJUndIZ2l3Z2tYZm9jN1dWUlBoRWVaR1ZKcmZsTDNFSnY1Z0VEZ2NQSGJQemRCMFZOcW9tVkMwZXQrSHArRm1CM1poRi8xZS83dTVjQ2tQb0Z0akhDM0VMeDlNZ3V0SXA2NGN1MXNpVXp1bm00aDJpcHVlYk9uWHZFRUhkelZwcW1kWjh0Tzd2UzdRK1FnN3dqVGUzek8velhJd0FvcHNzdWM2R3dMWXEzOVV4YWpDcz08L2RhdGE+Cgk8L2FycmF5PgoKCQkJCQkJCQkKCTxrZXk+RW50aXRsZW1lbnRzPC9rZXk+Cgk8ZGljdD4KCQkJCQoJCQkJPGtleT5hcHBsaWNhdGlvbi1pZGVudGlmaWVyPC9rZXk+CgkJPHN0cmluZz5LNzQ5QUVBREFYLm9uZS5nYW1lLmNvbTwvc3RyaW5nPgoJCQkJCgkJCQk8a2V5PmtleWNoYWluLWFjY2Vzcy1ncm91cHM8L2tleT4KCQk8YXJyYXk+CgkJCQk8c3RyaW5nPks3NDlBRUFEQVguKjwvc3RyaW5nPgoJCQkJPHN0cmluZz5jb20uYXBwbGUudG9rZW48L3N0cmluZz4KCQk8L2FycmF5PgoJCQkJCgkJCQk8a2V5PmdldC10YXNrLWFsbG93PC9rZXk+CgkJPGZhbHNlLz4KCQkJCQoJCQkJPGtleT5jb20uYXBwbGUuZGV2ZWxvcGVyLnRlYW0taWRlbnRpZmllcjwva2V5PgoJCTxzdHJpbmc+Szc0OUFFQURBWDwvc3RyaW5nPgoKCTwvZGljdD4KCTxrZXk+RXhwaXJhdGlvbkRhdGU8L2tleT4KCTxkYXRlPjIwMjEtMDgtMTVUMTA6NDM6NTZaPC9kYXRlPgoJPGtleT5OYW1lPC9rZXk+Cgk8c3RyaW5nPm9uZV9nYW1lX2FkaG9jPC9zdHJpbmc+Cgk8a2V5PlByb3Zpc2lvbmVkRGV2aWNlczwva2V5PgoJPGFycmF5PgoJCTxzdHJpbmc+YzRjOWQ3YWVlOGFmZDJjMjVlNDZiMGM0YTI4OGQ0NDZiMjA2NTlkOTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMzAtMDAxNjM1QzgzRUQyODAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+MmI5OGFjNjRjYTcwY2U5YWVmMDJkMDA2ZDFjZWFlZTcxNGQ1ZDQxZDwvc3RyaW5nPgoJCTxzdHJpbmc+MWRhOTZlZDliZmMxOGRhZWY3YmYxYzQ1OGIwNzllOGVkZmJmYmRkNDwvc3RyaW5nPgoJCTxzdHJpbmc+NTg5Y2U4OWFmN2M3NTQ3ZjMyMzcxYzQ3NzkwMDY5YjcxMjU0MzIwODwvc3RyaW5nPgoJCTxzdHJpbmc+ZWUxZTRmOGQ5ZTk1ZmIwYTdhZTY4ZmUxMDAyNGQ0YzMzZTM4OTlkOTwvc3RyaW5nPgoJCTxzdHJpbmc+YWMwM2IyN2Q1ZjdiN2NiYWM0YjdjNTg5YzMzMTFhNWFhM2JmODkwMzwvc3RyaW5nPgoJCTxzdHJpbmc+NDYzMWMxNTBjNGE5OGQ1MTA0ZDFjNDY2NzlhZWNkODAwOGJmMzg2Yjwvc3RyaW5nPgoJCTxzdHJpbmc+ZjIyOWEyMjZkNmQ0NjAwZDI4NzU1YjJiZmQxMmFlYWI4NTk2ODJhMTwvc3RyaW5nPgoJCTxzdHJpbmc+NDhhMWUwYjA3YmQ4YzU5MTViNjZmZGZkODgzMmFlODVhY2JiMjk5MDwvc3RyaW5nPgoJCTxzdHJpbmc+MTFmZTE2M2E1MDU2ZmM4NzBjYzJkY2U2ODRhZTFhM2YzYjMyN2U1NDwvc3RyaW5nPgoJCTxzdHJpbmc+YTVkMTU4NmRiMTlmMmI0ZjYzYjlhNzFhOTc4M2ZiNTc1OTYyYzJjMDwvc3RyaW5nPgoJCTxzdHJpbmc+NDJlNWFhMDdjMTFlYWFkMDI1OWRiZDczNWRkOWM1ZjE3NTc4ZjY0Yzwvc3RyaW5nPgoJCTxzdHJpbmc+MTY2ZTkzYmNiMzZkNTI1YjJlYjc0ZDZhMDNjMGU0M2QwNmU5YjAxNjwvc3RyaW5nPgoJCTxzdHJpbmc+OTQxY2ZhMGRlYmYzZTUwNWUxYjljYmFlZjllOWZhY2UyNWQ2NWExMTwvc3RyaW5nPgoJCTxzdHJpbmc+ZmNmODE1Y2Y0MWRlZDIzZWM5NjI3NzNlNTUzNzA2NTlkMjIyNjAyYTwvc3RyaW5nPgoJCTxzdHJpbmc+M2U1YzEyMGUwYjM4NTcwYjBjZWI3NjBkMDFhZGMyZGJjMjRjMjY5Yzwvc3RyaW5nPgoJCTxzdHJpbmc+ZTgwOTlmZTliMzBkODExOWJiNGY1MjBmMmZhODMxMzdmYWIxM2Q2MDwvc3RyaW5nPgoJCTxzdHJpbmc+NGY1OGVhMzkyNjk0NmRlNjgyOGFjZjhjMmMxZWE2MzQwOTFmY2VkNjwvc3RyaW5nPgoJCTxzdHJpbmc+ZmMxOTNkYzg1NmFkMjI1NGRmYTJhZTE1ODIxODk4ZjRiNmZkMjQxZTwvc3RyaW5nPgoJCTxzdHJpbmc+OGQ0Yjc5YjBlYzQ5NzE4YTg3ODljMjIzMjA2ZTdmNGI2NjhjOWFmODwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwODItMDAwQjI1MDAzQUUxMDAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMjAtMDAwOTU0MUMyNjAxMDAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+YWVlMjhmZjJiNmJjNTZhNDk4NTc3ZWNlYzEyZjhiNTEzZGNlODlmMzwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMjAtMDAwMjc4ODQyNkU5MDAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+YjQyZDNmYjY2OTMzYTQzYzczMWYyYTQyYWJmY2RhNmViMGQxNTJmMTwvc3RyaW5nPgoJCTxzdHJpbmc+ZWFmYmY1N2QyZWY4ZjViYmNkNWE0ZmYzNzYxOGY0MzQ5ZGRkMjkyYTwvc3RyaW5nPgoJCTxzdHJpbmc+ZGFlNjA3YTQ0MmMzMmUzMjQzNTBlYTZiY2JiYmQzOTQzM2M2NDViYjwvc3RyaW5nPgoJCTxzdHJpbmc+YjNiM2ZjZTQ4NzZhYmZhZThhMDE2N2I2ZTIyNjIwNWY4YjM0NDlmNDwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMzAtMDAwMTU1NDkyNkQzODAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMjAtMDAwMjc1NjQwMjBCMDAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+ZTQzM2RhZjc0MDMwNDRiZjA3NjNmMWM0ZWUxODEyYmZjOTM4ZmI2NDwvc3RyaW5nPgoJCTxzdHJpbmc+OGE1MjI2ZmQ0NTM1MzY2ODI5ZTQwYzIxNDYzMTYwNTcyN2JkYzAyODwvc3RyaW5nPgoJCTxzdHJpbmc+YWQ0ZjQxYjE5ZjljY2M0NTk2M2EyZDEzODJhYzRjODVhZGE0NzUyYjwvc3RyaW5nPgoJCTxzdHJpbmc+ZGI5YmY5NTQzODNmNGQxZjcwZTU5NDM3YWE0YjZhZTIyNGU3NzEzOTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMzAtMDAwOTBDRUEzNDc4ODAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMzAtMDAxNTY0NDQxMUMyODAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+NmU4NjBjNGNhNDE1ZjEwMTdjYmEzODNkODJjZjZmMWZkYWQ3MjVjNzwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMjAtMDAwQjI1MDAzQUUxMDAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMjAtMDAwMzI0QUMxNEYxMDAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMjctMDAxMTYxQTIyRTA3MDAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+MDAwMDgwMzAtMDAxNDU5NjkyRUU4ODAyRTwvc3RyaW5nPgoJCTxzdHJpbmc+ZjIzN2FkODQ5MWQ4YWRlMTg0NDlhNThhMzcwNjhiNmVjNDg4NjJiMjwvc3RyaW5nPgoJCTxzdHJpbmc+ZWQzZTU5YTI1YzhhZWU3NmEwMGJlZWRkZGE3NWZkMzExOTcwZjNmYTwvc3RyaW5nPgoJCTxzdHJpbmc+NzY2OGM4NGMzYTM5ZDg3MzY0ZWE4ODFjODUzNjc2NWQzMDZkODMyYTwvc3RyaW5nPgoJCTxzdHJpbmc+ODJiYWIzOWUxOGM1NzAxMDlhN2U1NjM2MTkzNWJkMzk3YTczYmUyYTwvc3RyaW5nPgoJCTxzdHJpbmc+ODIyMmIzM2M3NWRlZGFlZWFmOWQzOGJlNDNiNDNjMDNhOTFjNjdjNjwvc3RyaW5nPgoJCTxzdHJpbmc+Mzc2MGM2NjdmNDU2ODIyYTA0NTE1MGQwZGEwZjFlNzBhZTkyOWRkNjwvc3RyaW5nPgoJCTxzdHJpbmc+ZmFhYzM4OGIxOGNjZjU3ODYwMThjMWY0ZDEyZDFiMmE2ZGE1ZDcxMTwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+VGVhbUlkZW50aWZpZXI8L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPks3NDlBRUFEQVg8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PlRlYW1OYW1lPC9rZXk+Cgk8c3RyaW5nPkJlaWppbmcgUm93ZW5hIFRlY2hub2xvZ3kgQ28uLCBMdGQuPC9zdHJpbmc+Cgk8a2V5PlRpbWVUb0xpdmU8L2tleT4KCTxpbnRlZ2VyPjM2NDwvaW50ZWdlcj4KCTxrZXk+VVVJRDwva2V5PgoJPHN0cmluZz5lYzc5YzlhMS0yM2RiLTQxM2ItODg4NS1hNmIzOWZlNGUyOWU8L3N0cmluZz4KCTxrZXk+VmVyc2lvbjwva2V5PgoJPGludGVnZXI+MTwvaW50ZWdlcj4KPC9kaWN0Pgo8L3BsaXN0PqCCDLIwggPzMIIC26ADAgECAgEXMA0GCSqGSIb3DQEBBQUAMGIxCzAJ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 }}
        run: |
          exec .github/scripts/import-profile.sh
      - name: Build app
        run: |
          fastlane run build_app
      - name: Upload build artifacts
        uses: actions/upload-artifact@v2
        with:
          name: build.log
          path: ~/Library/Logs/gym/*.log

      - name: Upload release assets
        if: startsWith(github.ref, 'refs/tags/v')
        uses: softprops/action-gh-release@v1
        with:
          files: |
            ${{ env.PRODUCT_NAME }}.ipa
            ${{ env.PRODUCT_NAME }}.app.dSYM.zip
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload app to App Store Connect
        if: startsWith(github.ref, 'refs/tags/v')
        env:
          APP_STORE_CONNECT_USERNAME: ${{ secrets.APP_STORE_CONNECT_USERNAME }}
          APP_STORE_CONNECT_PASSWORD: ${{ secrets.APP_STORE_CONNECT_PASSWORD }}
        run: |
          xcrun altool --upload-app -t ios -f "$PRODUCT_NAME.ipa" -u "$APP_STORE_CONNECT_USERNAME" -p "$APP_STORE_CONNECT_PASSWORD"
